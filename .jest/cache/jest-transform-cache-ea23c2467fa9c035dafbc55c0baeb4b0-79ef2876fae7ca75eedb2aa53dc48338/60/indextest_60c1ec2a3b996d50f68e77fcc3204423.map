{"file":"/Users/Shared/Previously Relocated Items/Security/myProjiect/ai_projet/tests/index.test.ts","mappings":"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","names":[],"sources":["/Users/Shared/Previously Relocated Items/Security/myProjiect/ai_projet/tests/index.test.ts"],"sourcesContent":["import { UpdateNotifier } from '../src/index';\n\ndescribe('UpdateNotifier 简化测试', () => {\n  // 在每个测试前重置全局模拟\n  beforeEach(() => {\n    // 清除所有现有的模拟\n    jest.clearAllMocks();\n    \n    // 基本的浏览器API模拟\n    global.window = {\n      ...global.window,\n      confirm: jest.fn(() => true),\n      setTimeout: jest.fn((callback) => {\n        if (typeof callback === 'function') {\n          callback();\n        }\n        return 1;\n      }),\n      clearTimeout: jest.fn(),\n      location: {\n        reload: jest.fn()\n      }\n    } as any;\n    \n    global.document = {\n      ...global.document,\n      addEventListener: jest.fn(),\n      removeEventListener: jest.fn(),\n      hidden: false,\n    } as any;\n    \n    global.fetch = jest.fn().mockResolvedValue({\n      text: jest.fn().mockResolvedValue('<html><script src=\"/test.js\"></script></html>')\n    });\n  });\n  \n  // 测试实例创建\n  test('UpdateNotifier可以被实例化', () => {\n    expect(() => new UpdateNotifier()).not.toThrow();\n  });\n  \n  test('UpdateNotifier接受不同的配置选项', () => {\n    const optionsList = [\n      { pollingInterval: 10000 },\n      { indexPath: '/custom-index.html' },\n      { scriptRegex: /script/ },\n      { promptMessage: '有新版本！' },\n      { notificationType: 'confirm' as const },\n      { immediate: false },\n      { pauseOnHidden: false },\n    ];\n    \n    optionsList.forEach(options => {\n      expect(() => new UpdateNotifier(options)).not.toThrow();\n    });\n  });\n  \n  // 测试公共方法\n  test('公共方法可以被安全调用', () => {\n    const notifier = new UpdateNotifier({ pollingInterval: null });\n    \n    // 确保所有公共方法都可以被调用\n    expect(() => notifier.start()).not.toThrow();\n    expect(() => notifier.stop()).not.toThrow();\n    expect(() => notifier.reset()).not.toThrow();\n  });\n  \n  // 异步方法测试\n  test('异步方法不会抛出未捕获的异常', async () => {\n    const notifier = new UpdateNotifier({ pollingInterval: null });\n    \n    // 测试异步方法不会抛出未捕获的异常\n    await expect(notifier.checkNow()).resolves.not.toThrow();\n    await expect(notifier.checkUpdate()).resolves.not.toThrow();\n  });\n  \n  // 回调函数测试\n  test('回调函数配置有效', () => {\n    const onUpdate = jest.fn(() => true);\n    const onDetected = jest.fn();\n    \n    const notifier = new UpdateNotifier({\n      pollingInterval: null,\n      onUpdate,\n      onDetected\n    });\n    \n    expect(notifier).toBeDefined();\n  });\n  \n  // 边界情况测试\n  test('重复调用方法不会导致错误', () => {\n    const notifier = new UpdateNotifier({ pollingInterval: null });\n    \n    // 测试重复调用\n    expect(() => {\n      notifier.start();\n      notifier.start(); // 重复调用\n      notifier.stop();\n      notifier.stop(); // 重复调用\n      notifier.reset();\n      notifier.reset(); // 重复调用\n    }).not.toThrow();\n  });\n});"],"version":3}